<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include("partials/head") %>
  </head>
  <body data-theme="light">
    <%- include("partials/header") %>
    <main class="container">
      <section class="utils grid">
        <nav aria-label="breadcrumb" class="folderNav">
          <ul>
            <li><a href="/">/</a></li>
            <!-- Iterating over the list of folder names from parent folders to current -->
            <% if (locals.currentFolderArr)
            currentFolderArr.forEach((chunk, index) => { %>
            <li>
              <% if (index === currentFolderArr.length - 1) { %>
                <%= chunk %>
              <% } else { %>
                <a href="/vault/<%= currentFolderArr.slice(0, index + 1).join("/") %>"><%= chunk %></a>
              <% } %>
            </li>
            <% }) %>
          </ul>
        </nav>
        
        <button
          class="fileUpload"
          data-target="fileUploadModal"
          onclick="toggleModal(event)"
        >
          <%- include("svg/fileUpload.svg") %>
        </button>
        <button
          class="newFolder contrast"
          data-target="newFolderModal"
          onclick="toggleModal(event)"
        >
          <%- include("svg/createNewFolder.svg") %>
        </button>
      </section>
      <section class="itemsContainer">
        <% if(locals.folders) folders.forEach(folder => { %>
          <div class="folderBox">
            <a
              class="folder outline secondary"
              role="button"
              href="/vault/<%= folder.name %>"
            >
              <%- include("svg/folder.svg") %> <%= folder.name.split("/").at(-1) %>

            </a>

            <details class="dropdown">
              <summary><%- include("svg/bi--three-dots-vertical.svg")%></summary>
              <ul>
                  <li><a href="/"><%- include("svg/mdi--edit.svg")%> Edit</a></li>
                  <li><a href="/"><%- include("svg/mdi--delete.svg")%> Delete</a></li>
              </ul>
            </details>

          </div>
        <% }) %>
        <% if(locals.files) files.forEach(file => { %>
        <a
          class="file outline"
          role="button"
          href="/vault"
        >
          <%- include(`svg/mdi--file-${file.mimetype.split("/").at(0)}.svg`) %> <%= file.name %>     

        </a>
        <% }) %>
      </section>
      <%- include("partials/errors.ejs") %> 
      <%- include("partials/newFolderModal.ejs") %> 
      <%- include("partials/fileUploadModal.ejs") %>
    </main>
  </body>
</html>
